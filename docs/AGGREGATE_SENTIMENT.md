# 📰 aggregate_sentiment.py

## 📌 Purpose
Aggregates **per-headline sentiment scores** from the news sentiment pipeline into **daily averages**.  
This prepares sentiment data for merging with SPY technical indicators.

---

## ⚙️ Workflow
1. **Load sentiment CSV**
   - Reads `data/processed/news_with_sentiment.csv` generated by:
     - `news_sentiment_mac.py` (macOS-friendly)
     - or `finbert_sentiment_pipeline.py` (Linux/high-performance)
2. **Parse dates**
   - Ensures the `date` column is in datetime format.
3. **Aggregate sentiment scores**
   - Groups by `date` and calculates the **mean** for:
     - `positive`
     - `neutral`
     - `negative`
     - `compound`
4. **Count headlines per day**
   - Adds a `headline_count` column representing the number of headlines collected on each date.
5. **Save processed data**
   - Outputs `data/processed/daily_sentiment.csv`.

---

## 🛠 Key Outputs
- **`daily_sentiment.csv`**
  - Contains **one row per day** with:
    - Mean sentiment scores.
    - Headline count.
- Used directly by `merge_spy_sentiment.py`.

---

## 📈 Example Output
| date       | positive | neutral | negative | compound | headline_count |
|------------|----------|---------|----------|----------|----------------|
| 2025-07-10 | 0.12     | 0.70    | 0.18     | -0.06    | 18             |
| 2025-07-11 | 0.15     | 0.68    | 0.17     | -0.02    | 20             |

---

## 🔮 Future Improvements
- Fill missing dates to ensure continuous coverage.
- Apply weighted aggregation based on headline importance.
- Track sentiment volatility across multiple time windows.
